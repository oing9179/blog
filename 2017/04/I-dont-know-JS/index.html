<!doctype html>




<html class="theme-next mist" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="JavaScript,You don't know JS," />





  <link rel="alternate" href="/blog/rss2.xml" title="oing9179 的笔记本儿" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=5.1.0" />






<meta name="description" content="《你不知道的JS》 (You don’t know JS) 读书笔记

Preface一直以为 JavaScript 就是 Script 版的 Java，但在看了这本书后才知道，它丫的就是个 Script，跟 Java 一点儿关系都没有。JS 有一些 Java 没有的特性，比如：

拿 function 当对象用（看过书后发现 function 真的是个对象）
除了 null 还有 undefi">
<meta property="og:type" content="article">
<meta property="og:title" content="我不知道的JS">
<meta property="og:url" content="https://oing9179.github.io/blog/2017/04/I-dont-know-JS/index.html">
<meta property="og:site_name" content="oing9179 的笔记本儿">
<meta property="og:description" content="《你不知道的JS》 (You don’t know JS) 读书笔记

Preface一直以为 JavaScript 就是 Script 版的 Java，但在看了这本书后才知道，它丫的就是个 Script，跟 Java 一点儿关系都没有。JS 有一些 Java 没有的特性，比如：

拿 function 当对象用（看过书后发现 function 真的是个对象）
除了 null 还有 undefi">
<meta property="og:image" content="https://assets-cdn.github.com/images/icons/emoji/unicode/1f615.png">
<meta property="og:updated_time" content="2017-04-13T06:00:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我不知道的JS">
<meta name="twitter:description" content="《你不知道的JS》 (You don’t know JS) 读书笔记

Preface一直以为 JavaScript 就是 Script 版的 Java，但在看了这本书后才知道，它丫的就是个 Script，跟 Java 一点儿关系都没有。JS 有一些 Java 没有的特性，比如：

拿 function 当对象用（看过书后发现 function 真的是个对象）
除了 null 还有 undefi">
<meta name="twitter:image" content="https://assets-cdn.github.com/images/icons/emoji/unicode/1f615.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://oing9179.github.io/blog/2017/04/I-dont-know-JS/"/>





  <title> 我不知道的JS | oing9179 的笔记本儿 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-91332739-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/blog/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">oing9179 的笔记本儿</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">This is subtitle.</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/blog/links" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            Links
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://oing9179.github.io/blog/blog/2017/04/I-dont-know-JS/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="oing9179">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="https://www.gravatar.com/avatar/e1bd13468682c8192041be77e8136ea5?s=128">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="oing9179 的笔记本儿">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="oing9179 的笔记本儿" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                我不知道的JS
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-10T15:05:39+08:00">
                10 April 2017
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Programming/Front-end-Development/" itemprop="url" rel="index">
                    <span itemprop="name">Front-end Development</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/blog/2017/04/I-dont-know-JS/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/04/I-dont-know-JS/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p><em>《你不知道的JS》 (You don’t know JS) 读书笔记</em></p>
</blockquote>
<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>一直以为 JavaScript 就是 Script 版的 Java，但在看了这本书后才知道，它丫的就是个 Script，跟 Java 一点儿关系都没有。<br>JS 有一些 Java 没有的特性，比如：</p>
<ul>
<li>拿 <code>function</code> 当对象用（看过书后发现 <code>function</code> 真的是个对象）</li>
<li>除了 <code>null</code> 还有 <code>undefined</code> 还有 <code>undecleared</code></li>
<li><code>var</code> 定义的变量的作用域不符合常理（至少我觉得跟 Java 里定义出来的变量的作用域不一样）</li>
<li><code>this</code> is not this.</li>
<li>“半残”的面向对象概念</li>
<li>etc.</li>
</ul>
<p>我本来还想指望看完这系列书后能对 JS 的刻板印象有所改观，然而事与愿违。<br>下面我将以一个水平不及初级Lava程序员的程序员的角度，为本书做一份笔记。<br><a id="more"></a></p>
<h1 id="作用域和闭包（Scope-amp-Closures）"><a href="#作用域和闭包（Scope-amp-Closures）" class="headerlink" title="作用域和闭包（Scope &amp; Closures）"></a>作用域和闭包（Scope &amp; Closures）</h1><h2 id="1-变量作用域因-var-而变得奇葩"><a href="#1-变量作用域因-var-而变得奇葩" class="headerlink" title="1. 变量作用域因 var 而变得奇葩"></a>1. 变量作用域因 <code>var</code> 而变得奇葩</h2><p>先看代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> num = <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(num); <span class="comment">// Output: 1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(num); <span class="comment">// Uncaught ReferenceError: num is not defined</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在 Java 里，<code>num</code> 离开大括号后就应该是未定义的了，然而 JS 却唱反调。解决办法也很简单，使用 ECMAScript 6 的新关键字 <code>let</code> 即可，用法和 <code>var</code> 完全一致 但不会有 <code>var</code> 那种奇葩的作用域。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">let</span> num = <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(num); <span class="comment">// Uncaught ReferenceError: num is not defined</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(num); <span class="comment">// Uncaught ReferenceError: num is not defined</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>另外 <code>fn2()</code> 无论如何都是抛出 <code>ReferenceError</code>，说明 <code>var</code> 的作用域仅限于 <code>function</code> 内。<br>总结：</p>
<ol>
<li>能用 <code>let</code> 就不要用 <code>var</code></li>
<li><code>let</code> 的作用域在它所在的大括号内，<code>var</code> 的作用域在它所在的 <code>function</code> 内</li>
</ol>
<h3 id="1-1-用淫技”伪造”一个块作用域（Block-Scope）"><a href="#1-1-用淫技”伪造”一个块作用域（Block-Scope）" class="headerlink" title="1.1 用淫技”伪造”一个块作用域（Block Scope）"></a>1.1 用淫技”伪造”一个块作用域（Block Scope）</h3><p>正如书中所述，JS的块作用域很模糊。既然函数可以产生一个作用域，那么 借助它就可以不使用 <code>let</code> 关键字来产生一个 “块作用域”：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">param1</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> unaccessible = <span class="literal">true</span>;</div><div class="line">    <span class="built_in">console</span>.log(param1);</div><div class="line">&#125;)(<span class="string">"Hello world"</span>); <span class="comment">// 会输出 "Hello world"</span></div><div class="line"><span class="built_in">console</span>.log(unaccessible); <span class="comment">// ReferenceError</span></div></pre></td></tr></table></figure>
<p>上面的代码的格式大概是这样的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="comment">/*该括号里声明函数*/</span>)(<span class="comment">/*该括号使得左边括号里的代码立即执行*/</span>);</div></pre></td></tr></table></figure>
<h2 id="2-提升（Hoisting）"><a href="#2-提升（Hoisting）" class="headerlink" title="2. 提升（Hoisting）"></a>2. 提升（Hoisting）</h2><p><strong>TL;DR:</strong> 使用任何变量前请先把它定义出来，这点对于 Java 程序员来讲很容易吧。</p>
<p>在看完书中 Hoisting 部分后，我的理解是这样的：任意位置定义出来的东西（包括但不限于变量、<code>function</code>）都会把 <strong>定义(Definition)</strong> 挪到函数最开始的位置。就像下面这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fnTest</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Hello, "</span>);</div><div class="line">    <span class="keyword">let</span> someone = <span class="string">"Walter White"</span>;</div><div class="line">    <span class="built_in">console</span>.log(someone);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>经过 Hoisting 后就会变成这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fnTest</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> someone;</div><div class="line">    </div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Hello, "</span>);</div><div class="line">    someone = <span class="string">"Walter White"</span>;</div><div class="line">    <span class="built_in">console</span>.log(someone);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其实”提升”是一种误解。我觉得把 StackOverflow 上的 <a href="https://stackoverflow.com/questions/15005098/why-does-javascript-hoist-variables" target="_blank" rel="external">这个问题的答案</a> 翻译一下来得更直接：</p>
<blockquote>
<p>As Stoyan Stefanov explains in “JavaScript Patterns” book, the hoisting is result of JavaScript interpreter implementation.<br>Stoyan Stefanov 在 《JavaScript Patterns》 一书中解释道，这种 Hoisting 现象其实是由 JS 的解释器的实现导致的。</p>
<p>The JS code interpretation performed in two passes. During the first pass, the interpreter processes variable and function declarations.<br>解释器解释 JS 代码的时候会把 JS 代码过两遍。第一遍处理所有的变量和函数定义。</p>
<p>The second pass is actually code execution step. The interpreter processes function expressions and undeclared variables.<br>第二遍在才会执行具体的 JS 代码，处理函数表达式以及未定义的变量。</p>
<p>Thus, we can use the “hoisting” concept to describe such behavior.<br>因此，我们可以用 “提升” 这个概念来形容这种行为。</p>
<p>Hope this helps.<br>- <a href="https://stackoverflow.com/users/1557262/lxgreen" target="_blank" rel="external">lxgreen</a> answered Feb 22 ‘13 at 0:22</p>
<p>I personally really do not like the word “hoisting”. It gives the false representation that variable and function declarations are magically hoisted to the top of the current scope, when in reality, the JS interpreter, as you mentioned, scans the source code for the bindings and <strong>then</strong> executes the code. – <a href="https://stackoverflow.com/users/175057/contactmatt" target="_blank" rel="external">contactmatt</a> Feb 24 ‘13 at 22:32<br>我个人非常不喜欢 “提升” 这个词。它会给人一种错误的观念，让人以为变量和函数的定义都被神奇的提升到了当前作用域最开始的位置。但实际情况是，正如你所提到的，JS 解释器会先扫描代码中的所有绑定（这里绑定指的是把函数或变量绑定到某个变量名上）<strong>然后</strong>再执行具体的代码。</p>
</blockquote>
<h2 id="3-闭包"><a href="#3-闭包" class="headerlink" title="3. 闭包"></a>3. 闭包</h2><p>强烈建议阅读原书，不过我在这里依然会做简单的介绍。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fnTest</span>(<span class="params">param0</span>) </span>&#123;</div><div class="line">    $(<span class="string">".button"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(param0);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用鼠标点击 <code>.button</code> 后 <code>console.log()</code> 可以访问 <code>param0</code>，这就是闭包。</p>
<h1 id="this-和对象原型（Object-Prototype）"><a href="#this-和对象原型（Object-Prototype）" class="headerlink" title="this 和对象原型（Object Prototype）"></a><code>this</code> 和对象原型（Object Prototype）</h1><h2 id="1-半残废的-OOP"><a href="#1-半残废的-OOP" class="headerlink" title="1. 半残废的 OOP"></a>1. 半残废的 OOP</h2><p>以我目前的理解：</p>
<ol>
<li>JS 的 <code>protytope</code> 就是 Java 的类</li>
<li>JS 的 <code>prototype</code> 链就是 Java 的类继承</li>
</ol>
<p>不过书中反复强调 JS 里没有类的概念。<img src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f615.png" style="width:24px; height:24px; display:inline !important; border:none; padding:0;"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义一个类的构造函数。是的，先定义构造函数，</span></div><div class="line"><span class="keyword">var</span> Clazz = <span class="function"><span class="keyword">function</span> <span class="title">Clazz</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.debug(<span class="string">"Clazz()"</span>);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// 然后再继续编写类的行为。很可惜的是，像下面这样定义类的行为的话，多态也就无从谈起了。</span></div><div class="line">Clazz.prototype.greeting = <span class="function"><span class="keyword">function</span> <span class="title">greeting</span>(<span class="params">someone</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Hello, "</span> + someone);</div><div class="line">&#125;;</div><div class="line"><span class="comment">// 然后 ECMAScript 的研发人员们又搞了这个：</span></div><div class="line">Clazz.prototype.getArguments = <span class="function"><span class="keyword">function</span> <span class="title">getArguments</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">arguments</span>;<span class="comment">// 请把 arguments 对象当作数组用，然后通过数组下标获取调用当前函数时所传入的参数，下标指向不存在的东西会返回 undefined.</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">// 实例化一个 Clazz "类"</span></div><div class="line"><span class="keyword">let</span> clazz = <span class="keyword">new</span> Clazz();</div><div class="line">clazz.greeting(<span class="string">"Walter White"</span>);<span class="comment">// 输出 "Hello, Walter White"</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">of</span> clazz.getArguments(<span class="string">"Hello"</span>, <span class="string">"Walter White"</span>)) &#123;</div><div class="line">    <span class="built_in">console</span>.log(p);</div><div class="line">    <span class="comment">/* 输出：</span></div><div class="line">    Hello</div><div class="line">    Walter White</div><div class="line">    */</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>改用 ES6 语法来定义类：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义类 Clazz</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cooker</span> </span>&#123;</div><div class="line">    <span class="comment">// 构造函数不能重载</span></div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">        <span class="keyword">this</span>.someone = <span class="built_in">arguments</span>[<span class="number">0</span>];</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"Cooker.constructor"</span>, <span class="built_in">arguments</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 普通的函数也不能重载</span></div><div class="line">    greeting() &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"Hello, "</span> + <span class="keyword">this</span>.someone);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WalterWhite</span> <span class="keyword">extends</span> <span class="title">Cooker</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="keyword">super</span>(<span class="string">"Walter White"</span>);</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"WalterWhite.constructor"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 使用方法</span></div><div class="line"><span class="keyword">let</span> cooker = <span class="keyword">new</span> Cooker(<span class="string">"Walter White"</span>);</div><div class="line"><span class="keyword">let</span> walterWhite = <span class="keyword">new</span> WalterWhite();</div><div class="line">cooker.greeting();<span class="comment">// 输出 "Hello, Walter White"</span></div><div class="line">cooker.greeting(<span class="string">"Walter White"</span>); <span class="comment">// 输出得和上一行代码一样</span></div><div class="line">walterWhite.greeting();</div></pre></td></tr></table></figure>
<p>其实到头来还是因为 JS 的半残废的面向对象系统，要多态没有多态，要静态变量没有静态变量，要访问控制没有访问控制。要我说吧，Script 就做好你 Script 的本职工作就好了，没有 Python 的实力还非要学别人搞 OOP。</p>
<h2 id="2-抱歉，没有静态类和静态变量"><a href="#2-抱歉，没有静态类和静态变量" class="headerlink" title="2. 抱歉，没有静态类和静态变量"></a>2. 抱歉，没有静态类和静态变量</h2><p>是的，没有静态类也没有静态变量，就如同书中 “this和对象原型 -&gt; 附录 A.2” 里说的一样。<br>想写静态变量的话，拿全局变量代替吧，在类里写静态变量事倍功半。</p>
<h2 id="3-this-is-not-this"><a href="#3-this-is-not-this" class="headerlink" title="3. this is not this."></a>3. <code>this</code> is not this.</h2><p>JS 里的 <code>this</code> 和 Java 里的 <code>this</code> 可谓是天壤之别，强烈建议阅读原书（原书里句句命中要害，几乎没有废话），下面借用第2章的总结：</p>
<ol>
<li>由 new 调用绑定到新创建的对象。</li>
<li>由 call 或者 apply(或者 bind)调用?绑定到指定的对象。</li>
<li>由上下文对象调用?绑定到那个上下文对象。</li>
<li>默认:在严格模式下绑定到 undefined,否则绑定到全局对象。</li>
</ol>
<p><em>未完待续…</em></p>
<h1 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h1><p>10 Apr 2017：首次发布<br>13 Apr 2017：</p>
<ul>
<li>更正：提升（Hoisting）现象的原理</li>
<li>小修小改</li>
</ul>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://stackoverflow.com/questions/15005098/why-does-javascript-hoist-variables" target="_blank" rel="external">Why does JavaScript hoist variables? - stackoverflow.com</a><blockquote>
<p>As Stoyan Stefanov explains in “JavaScript Patterns” book, the hoisting is result of JavaScript interpreter implementation.<br>The JS code interpretation performed in two passes. During the first pass, the interpreter processes variable and function declarations.<br>The second pass is actually code execution step. The interpreter processes function expressions and undeclared variables.<br>Thus, we can use the “hoisting” concept to describe such behavior.<br>Hope this helps.<br>- <a href="https://stackoverflow.com/users/1557262/lxgreen" target="_blank" rel="external">lxgreen</a> answered Feb 22 ‘13 at 0:22</p>
<p>I personally really do not like the word “hoisting”. It gives the false representation that variable and function declarations are magically hoisted to the top of the current scope, when in reality, the JS interpreter, as you mentioned, scans the source code for the bindings and <strong>then</strong> executes the code. – <a href="https://stackoverflow.com/users/175057/contactmatt" target="_blank" rel="external">contactmatt</a> Feb 24 ‘13 at 22:32</p>
</blockquote>
</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/JavaScript/" rel="tag"># JavaScript</a>
          
            <a href="/blog/tags/You-don-t-know-JS/" rel="tag"># You don't know JS</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2017/03/Setup-Nextcloud-using-Docker-and-Nginx/" rel="next" title="用 Docker 和 Nginx 搭建自己的云服务器（Nextcloud）">
                <i class="fa fa-chevron-left"></i> 用 Docker 和 Nginx 搭建自己的云服务器（Nextcloud）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2017/04/Java-Concurrency-Multi-Threading-Introduction/" rel="prev" title="Java 并发 & 多线程 - 基础知识">
                Java 并发 & 多线程 - 基础知识 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://www.gravatar.com/avatar/e1bd13468682c8192041be77e8136ea5?s=128"
               alt="oing9179" />
          <p class="site-author-name" itemprop="name">oing9179</p>
          <p class="site-description motion-element" itemprop="description">Develop with pleasure!</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/blog/archives">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/blog/categories">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/blog/tags">
                <span class="site-state-item-count">68</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/blog/rss2.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/oing9179" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/oing9179" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/blog/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Preface"><span class="nav-number">1.</span> <span class="nav-text">Preface</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#作用域和闭包（Scope-amp-Closures）"><span class="nav-number">2.</span> <span class="nav-text">作用域和闭包（Scope & Closures）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-变量作用域因-var-而变得奇葩"><span class="nav-number">2.1.</span> <span class="nav-text">1. 变量作用域因 var 而变得奇葩</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-用淫技”伪造”一个块作用域（Block-Scope）"><span class="nav-number">2.1.1.</span> <span class="nav-text">1.1 用淫技”伪造”一个块作用域（Block Scope）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-提升（Hoisting）"><span class="nav-number">2.2.</span> <span class="nav-text">2. 提升（Hoisting）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-闭包"><span class="nav-number">2.3.</span> <span class="nav-text">3. 闭包</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#this-和对象原型（Object-Prototype）"><span class="nav-number">3.</span> <span class="nav-text">this 和对象原型（Object Prototype）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-半残废的-OOP"><span class="nav-number">3.1.</span> <span class="nav-text">1. 半残废的 OOP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-抱歉，没有静态类和静态变量"><span class="nav-number">3.2.</span> <span class="nav-text">2. 抱歉，没有静态类和静态变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-this-is-not-this"><span class="nav-number">3.3.</span> <span class="nav-text">3. this is not this.</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#更新历史"><span class="nav-number">4.</span> <span class="nav-text">更新历史</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">5.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">oing9179</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'oing9179-blog';
      var disqus_identifier = '2017/04/I-dont-know-JS/';

      var disqus_title = "我不知道的JS";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  









  
  

  

  

  

  


</body>
</html>
