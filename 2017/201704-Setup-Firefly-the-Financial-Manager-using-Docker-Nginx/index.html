<!DOCTYPE html>













<html class="theme-next mist" lang="zh, en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">








  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

















<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/blog/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=7.1.2">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=7.1.2" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Mist',
    version: '7.1.2',
    sidebar: {"position":"left","display":"hide","offset":12,"onmobile":true,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Preface“我辛辛苦苦挣的钱都去哪儿了”，我可不希望以后什么什么时候开始说这种话，于是 搭建个记账软件来记录自己的收支吧。该软件优点如下：  资金流向：比如钱都花在哪些类目上了，钱都流向哪些商家了。 资金预算：比如打算每个月花多少钱在饮食上。 分类 &amp;amp; 标签：比如钱都花在那些类目上了。 交易记录：除了收入和支出记录外，如有多个银行账户的话 还能记录不同账户之间的转帐交易 存钱罐（Pig">
<meta name="keywords" content="Linux,Nginx,Docker,Firefly,Finical Manager">
<meta property="og:type" content="article">
<meta property="og:title" content="用 Docker &amp; Nginx 搭建自己的账本（Firefly）">
<meta property="og:url" content="https://oing9179.github.io/blog/2017/201704-Setup-Firefly-the-Financial-Manager-using-Docker-Nginx/index.html">
<meta property="og:site_name" content="Chiyuki&#39;s Notebook">
<meta property="og:description" content="Preface“我辛辛苦苦挣的钱都去哪儿了”，我可不希望以后什么什么时候开始说这种话，于是 搭建个记账软件来记录自己的收支吧。该软件优点如下：  资金流向：比如钱都花在哪些类目上了，钱都流向哪些商家了。 资金预算：比如打算每个月花多少钱在饮食上。 分类 &amp;amp; 标签：比如钱都花在那些类目上了。 交易记录：除了收入和支出记录外，如有多个银行账户的话 还能记录不同账户之间的转帐交易 存钱罐（Pig">
<meta property="og:locale" content="zh, en">
<meta property="og:updated_time" content="2017-05-13T08:53:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="用 Docker &amp; Nginx 搭建自己的账本（Firefly）">
<meta name="twitter:description" content="Preface“我辛辛苦苦挣的钱都去哪儿了”，我可不希望以后什么什么时候开始说这种话，于是 搭建个记账软件来记录自己的收支吧。该软件优点如下：  资金流向：比如钱都花在哪些类目上了，钱都流向哪些商家了。 资金预算：比如打算每个月花多少钱在饮食上。 分类 &amp;amp; 标签：比如钱都花在那些类目上了。 交易记录：除了收入和支出记录外，如有多个银行账户的话 还能记录不同账户之间的转帐交易 存钱罐（Pig">



  <link rel="alternate" href="/blog/rss2.xml" title="Chiyuki's Notebook" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://oing9179.github.io/blog/2017/201704-Setup-Firefly-the-Financial-Manager-using-Docker-Nginx/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>用 Docker & Nginx 搭建自己的账本（Firefly） | Chiyuki's Notebook</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh, en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Chiyuki's Notebook</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/blog/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/blog/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/blog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/blog/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://oing9179.github.io/blog/blog/2017/201704-Setup-Firefly-the-Financial-Manager-using-Docker-Nginx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oing9179">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chiyuki's Notebook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">用 Docker & Nginx 搭建自己的账本（Firefly）

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-18 07:47:03" itemprop="dateCreated datePublished" datetime="2017-04-18T07:47:03+08:00">2017-04-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2017-05-13 16:53:00" itemprop="dateModified" datetime="2017-05-13T16:53:00+08:00">2017-05-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/Server/" itemprop="url" rel="index"><span itemprop="name">Server</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/Server/Deployment/" itemprop="url" rel="index"><span itemprop="name">Deployment</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>“我辛辛苦苦挣的钱都去哪儿了”，我可不希望以后什么什么时候开始说这种话，于是 搭建个记账软件来记录自己的收支吧。<br>该软件优点如下：</p>
<ul>
<li>资金流向：比如钱都花在哪些类目上了，钱都流向哪些商家了。</li>
<li>资金预算：比如打算每个月花多少钱在饮食上。</li>
<li>分类 &amp; 标签：比如钱都花在那些类目上了。</li>
<li>交易记录：除了收入和支出记录外，如有多个银行账户的话 还能记录不同账户之间的转帐交易</li>
<li>存钱罐（Piggy Banks）：比如想买个手机但是目前没有那么多预算，可以先弄个存钱罐，然后一点一点的往里面存。相当于一个长远的资金预算。</li>
<li>账单：每月水电费之类的。</li>
<li>规则：比如填写支出描述时自动填写预设的支出金额。</li>
<li>报表（Reports）：按月、季、年生成报表，账户余额、资金流向、短期/长期预算、账单 等等。</li>
<li>多货币：软妹币, 美刀, 英镑, 比特币，想用什么就用什么（不支持货币换算，在创建收支记录时候可以手动填写换算前后的金额）。</li>
<li>数据导入导出：导入导出 <code>csv</code> 格式的文件，进一步对资金流向做分析什么的。</li>
</ul>
<p>目前我能想到的唯一缺点就是：没能和各种银行/支付机构（比如支付婊）进行接口对接，实现自动记录收入支出。<br>另外，该软件作者表示 “不支持自动支付重复性交易”，原因是：</p>
<blockquote>
<p>I believe that if you are serious about changing your financial habits, you should be aware of what happens on your accounts. The money you spend and the money you earn. By entering each transaction manually, you will <em>feel</em> what you spend.<br>我认为如果你真的想改变你的财务习惯的话，你应该更关心你的账户，你花的钱还有你挣的钱。通过手动地录入每次交易，让你<em>切实体会到</em>钱都花在哪里了。</p>
</blockquote>
<a id="more"></a>

<h1 id="安装-amp-更新-Docker-docker-ce"><a href="#安装-amp-更新-Docker-docker-ce" class="headerlink" title="安装 &amp; 更新 Docker (docker-ce)"></a>安装 &amp; 更新 Docker (<code>docker-ce</code>)</h1><p>近些天 Docker 更新了，连软件包名字也变了。<code>docker-ce</code> 对应 Docker 社区版（Community Edition），<code>docker-ee</code> 对应 Docker 企业版（Enterprise Edition）。</p>
<ol>
<li><p>如果原来安装过 Docker 的话，先卸载旧版</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove docker docker-engine</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过安装下面的软件包使 <code>apt</code> 通过 HTTPS 下载 Docker 安装包</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    software-properties-common</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 Docker 的 GPG key</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure>

<p> 执行命令 <code>sudo apt-key fingerprint 0EBFCD88</code> 后的输出应该大致是这样：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pub   4096R/0EBFCD88 2017-02-22</span><br><span class="line">      Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88</span><br><span class="line">uid                  Docker Release (CE deb) &lt;docker@docker.com&gt;</span><br><span class="line">sub   4096R/F273FCD8 2017-02-22</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 Docker 软件源</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository \</span><br><span class="line">   "deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span><br><span class="line"><span class="meta">   $</span><span class="bash">(lsb_release -cs) \</span></span><br><span class="line">   stable"</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 Docker</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get install docker-ce</span><br></pre></td></tr></table></figure>

<p> 然后等一段时间就安装好了。</p>
</li>
</ol>
<h1 id="构建和部署-Docker-Image"><a href="#构建和部署-Docker-Image" class="headerlink" title="构建和部署 Docker Image"></a>构建和部署 Docker Image</h1><ol>
<li><p>更新 <code>docker-compose</code> 到最新版，可以参考 <a href="https://github.com/docker/compose/releases" target="_blank" rel="noopener">这里</a> 的说明</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://github.com/docker/compose/releases/download/1.12.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
</li>
<li><p>从 GitHub clone Firefly 下来</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/firefly-iii/firefly-iii.git</span><br><span class="line">cd ./firefly-iii/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用 git checkout tags/&lt;版本号 tag&gt; -b &lt;新的分支名&gt; 来 checkout 指定版本的 Firefly</span></span><br><span class="line">git checkout tags/4.3.8 -b v4.3.8</span><br></pre></td></tr></table></figure>
</li>
<li><p>在当前目录下创建并编辑 <code>docker-compose.my.yml</code>，<code>environment</code> 里配置项的具体说明可以参考 <a href="https://firefly-iii.github.io/using-installing.html" target="_blank" rel="noopener">这里</a></p>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'2'</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  firefly-app:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">firefly-iii</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">.</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="attr">      FF_DB_HOST:</span> <span class="string">"localhost"</span> <span class="comment"># 这里暂时用 localhost，等 Firefly 部署后再进入 docker 容器查看 IP 地址</span></span><br><span class="line"><span class="attr">      FF_DB_NAME:</span> <span class="string">"firefly"</span> <span class="comment"># 数据库名称</span></span><br><span class="line"><span class="attr">      FF_DB_USER:</span> <span class="string">"firefly"</span> <span class="comment"># 数据库用户名</span></span><br><span class="line"><span class="attr">      FF_DB_PASSWORD:</span> <span class="string">"连接数据库的密码"</span></span><br><span class="line"><span class="attr">      FF_APP_KEY:</span> <span class="string">"32个随机英文和数字字符"</span></span><br><span class="line"><span class="attr">      FF_APP_ENV:</span> <span class="string">"production"</span></span><br><span class="line"><span class="attr">      SITE_OWNER:</span> <span class="string">"填写自己的邮箱"</span></span><br><span class="line"><span class="attr">      APP_FORCE_SSL:</span> <span class="string">"true"</span> <span class="comment"># 强制使用 HTTPS 连接</span></span><br><span class="line"><span class="attr">      APP_FORCE_ROOT:</span> <span class="string">"https://qian.example.com"</span> <span class="comment"># 改成自己网站的 URL, 下同</span></span><br><span class="line"><span class="attr">      APP_URL:</span> <span class="string">"https://qian.example.com"</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"127.0.0.1:8082:80/tcp"</span> <span class="comment"># 将 docker 容器的 80 端口映射到本机的 8082 端口上</span></span><br><span class="line"><span class="attr">    volumes:</span></span><br><span class="line">      <span class="comment"># 将 docker 容器内的 /var/www/firefly-iii/storage 映射到本机的 /somewhere/storage 目录下</span></span><br><span class="line">      <span class="comment"># storage 目录下将存放 Firefly 所需的文件（比如创建收支记录时候上传的附件）</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"/var/www/firefly-iii/storage:/somewhere/storage"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 Docker 容器，这一步会花费较长的时间</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f docker-compose.my.yml create</span><br></pre></td></tr></table></figure>
</li>
<li><p>对刚创建出来的 Docker 容器改名，改名前的名字大概会像下面这样，改成 <code>firefly</code> 省得后续再写命令时候写那么大一长串：</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rename fireflyiii_firefly-app_1 firefly</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动 Firefly Docker image</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start firefly</span><br></pre></td></tr></table></figure>

<p> 运行 <code>curl http://127.0.0.1:8082</code>，如果看到有 HTML 输出的话就行了。</p>
</li>
<li><p>查看 Docker 容器的 IP 和 Gateway</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进入正在运行的 Docker 容器内</span></span><br><span class="line">docker exec -i firefly /bin/bash -il</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 IP 和 Gateway</span></span><br><span class="line">ip route show default</span><br></pre></td></tr></table></figure>

<p> 输出的内容大致是这样，将 Gateway（也就是下面的 <code>127.17.0.1</code>）和 IP（也就是 <code>127.17.0.2</code>）记录下来备用：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">default via 172.17.0.1 dev eth0 # 127.17.0.1 就是 Gateway</span><br><span class="line">172.17.0.0/16 dev eth0  proto kernel  scope link  src 172.17.0.2 # 127.17.0.2 就是 Docker 容器的 IP</span><br></pre></td></tr></table></figure>
</li>
<li><p>编辑 <code>docker-compose.my.yml</code>，修改内容如下：</p>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 FF_DB_HOST 由 localhost 改为上面的 Gateway</span></span><br><span class="line"><span class="attr">FF_DB_HOST:</span> <span class="string">"172.17.0.1"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行下面命令来创建新的 Docker 容器</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">kill</span> 掉正在运行的 Docker 容器</span></span><br><span class="line">docker kill firefly</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删掉容器和旧的 Docker Image</span></span><br><span class="line">docker rm firefly</span><br><span class="line">docker rmi firefly-iii</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建新的 Docker 容器，这将应用前面对 docker-compose.my.yml 的修改</span></span><br><span class="line">docker-compose -f docker-compose.my.yml create</span><br><span class="line"><span class="meta">#</span><span class="bash"> 改名</span></span><br><span class="line">docker rename fireflyiii_firefly-app_1 firefly</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动 Docker 容器</span></span><br><span class="line">docker start firefly</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行命令 <code>curl http://127.0.0.1:8082</code>，应该会有 HTML 输出</p>
</li>
</ol>
<p>接下来开始弄 Nginx。</p>
<h1 id="安装-amp-配置-Nginx"><a href="#安装-amp-配置-Nginx" class="headerlink" title="安装 &amp; 配置 Nginx"></a>安装 &amp; 配置 Nginx</h1><h2 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install nginx</span><br></pre></td></tr></table></figure>

<p>装完了就 <code>curl http://127.0.0.1</code> 看看效果。</p>
<h2 id="生成-Let’s-Encrypt-SSL-证书"><a href="#生成-Let’s-Encrypt-SSL-证书" class="headerlink" title="生成 Let’s Encrypt SSL 证书"></a>生成 Let’s Encrypt SSL 证书</h2><ol>
<li><p>先为自己的域名添加一个 <code>CNAME</code> 记录，本文将以 <code>qian.example.com</code> 为例。</p>
</li>
<li><p>在路径 <code>/var/www/</code> 下创建一个文件夹名为 <code>qian.example.com</code></p>
</li>
<li><p>创建并编辑文件 <code>/etc/nginx/sites-available/qian.example.com</code>，文件内容如下</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen [::]:80;</span><br><span class="line">    server_name qian.example.com;</span><br><span class="line">    root /var/www/qian.example.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ =404;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启 Nginx <code>systemctl restart nginx</code></p>
</li>
<li><p>生成 SSL 证书</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">letsencrypt certonly --webroot -w /var/www/qian.example.com --domain "qian.example.com"</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="配置-Nginx-使用-SSL"><a href="#配置-Nginx-使用-SSL" class="headerlink" title="配置 Nginx 使用 SSL"></a>配置 Nginx 使用 SSL</h2><p>编辑文件 <code>/etc/nginx/sites-available/qian.example.com</code>，文件内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    server_name qian.example.com;</span><br><span class="line"></span><br><span class="line">    listen 443 default_server;</span><br><span class="line">    listen [::]:443 default_server;</span><br><span class="line">    access_log /var/log/nginx/$&#123;server_name&#125;_access.log;</span><br><span class="line"></span><br><span class="line">    # SSL 证书的配置，把 qian.example.com 改成自己的就好了</span><br><span class="line">    ssl on; </span><br><span class="line">    ssl_certificate /etc/letsencrypt/live/qian.example.com/fullchain.pem;</span><br><span class="line">    ssl_certificate_key /etc/letsencrypt/live/qian.example.com/privkey.pem;</span><br><span class="line"></span><br><span class="line">    index index.html index.php;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        # proxy_pass：将 HTTP 请求转发到指定端口</span><br><span class="line">        proxy_pass http://127.0.0.1:8082;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=15552000; includeSubDomains; preload&quot; always;</span><br><span class="line">        client_max_body_size 16M;</span><br><span class="line">    &#125;</span><br><span class="line">    location = /.htaccess &#123;</span><br><span class="line">        return 403;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重启 Nginx <code>systemctl restart nginx</code>，然后执行 <code>curl https://qian.example.com</code>，输出的 HTML 应该和刚启动完 Firefly 时的输出是一样的。</p>
<h1 id="初始化-Firefly"><a href="#初始化-Firefly" class="headerlink" title="初始化 Firefly"></a>初始化 Firefly</h1><h2 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h2><ol>
<li><p>在 MariaDB 里为 Firefly 创建 <code>firefly</code> 数据库</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建 firefly 数据库</span><br><span class="line">CREATE DATABASE firefly CHARACTER SET = utf8 COLLATE = utf8_general_ci;</span><br><span class="line">-- 创建 firefly 用户</span><br><span class="line">CREATE USER firefly IDENTIFIED BY &apos;Passw0rd&apos;;</span><br><span class="line">-- 让用户 firefly 拥有 firefly 数据库的完整权限</span><br><span class="line">GRANT ALL ON firefly.* TO firefly;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行下面的命令创建数据库表</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进入正在运行的 firefly Docker 容器</span></span><br><span class="line">docker exec -i firefly /bin/bash -il</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果当前目录不是 /var/www/firefly-iii/ 下面的话则 <span class="built_in">cd</span> 过去</span></span><br><span class="line">cd /var/www/firefly-iii/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行命令来初始化数据库表</span></span><br><span class="line">php artisan migrate:refresh --seed --force</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="注册并登录"><a href="#注册并登录" class="headerlink" title="注册并登录"></a>注册并登录</h2><p>打开浏览器访问 <code>https://qian.example.com</code>，注册一个帐号即可。注册完成后 注册功能会自动关闭，默认情况下只允许单个用户使用这个网站，如果想多人使用的话 可以在设置里取消勾选 “Single user mode”。</p>
<h1 id="更新-Firefly"><a href="#更新-Firefly" class="headerlink" title="更新 Firefly"></a>更新 Firefly</h1><p>如果 Firefly 更新了，大致可以按照下面的步骤做，一共3步。</p>
<h2 id="1-备份数据库"><a href="#1-备份数据库" class="headerlink" title="1. 备份数据库"></a>1. 备份数据库</h2><p>执行下面的命令，将整个 <code>firefly</code> 数据库全部备份出来。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mysqldump --databases firefly --triggers --routines --events --single-transaction | gzip -c &gt; mysql_db_firefly_$(date +%Y%m%d_%H%M_%s).sql.gz</span><br></pre></td></tr></table></figure>

<h2 id="2-更新-docker-镜像"><a href="#2-更新-docker-镜像" class="headerlink" title="2. 更新 docker 镜像"></a>2. 更新 docker 镜像</h2><p><code>cd</code> 到 firefly-iii 的文件的目录下，执行下面的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从 GitHub 拉取更新</span></span><br><span class="line">git pull</span><br><span class="line"><span class="comment"># 构建新的 docker 镜像</span></span><br><span class="line">docker-compose -f docker-compose.my.yml build</span><br><span class="line"><span class="comment"># 为 firefly docker 镜像改 tag</span></span><br><span class="line">docker tag firefly-iii:latest firefly-iii:v4.4.3</span><br><span class="line"><span class="comment"># 使用 firefly docker 镜像创建 firefly docker 容器</span></span><br><span class="line">docker-compose -f docker-compose.my.yml create</span><br><span class="line"><span class="comment"># 将新的 firefly docker 容器的名字改为 firefly</span></span><br><span class="line">docker rename fireflyiii_firefly-app_1 firefly</span><br><span class="line"><span class="comment"># 启动 docker 容器</span></span><br><span class="line">docker start firefly</span><br></pre></td></tr></table></figure>

<h2 id="3-收尾工作"><a href="#3-收尾工作" class="headerlink" title="3. 收尾工作"></a>3. 收尾工作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入并运行 firefly docker 容器内的 /bin/bash</span></span><br><span class="line">docker <span class="built_in">exec</span> -i firefly /bin/bash -il</span><br><span class="line"><span class="comment"># 执行下面3条命令就行了，具体它们做的啥 我也不知道，也不用知道.</span></span><br><span class="line">php artisan migrate --env=production --force</span><br><span class="line">php artisan cache:clear</span><br><span class="line">php artisan firefly:upgrade-database</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>有了之前搭建 Nextcloud 的经验，这次搭建起来省了不少时间。</p>
<h1 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h1><p>18 Apr 2017: 首次发布<br>19 Apr 2017:</p>
<ul>
<li>在 “构建和部署 Docker Image” 中增加 <code>curl</code> 命令来验证 Docker 容器是否启动</li>
<li>小修小改</li>
</ul>
<p>13 May 2017:</p>
<ul>
<li>添加章节：更新 Firefly</li>
</ul>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a href="https://docs.docker.com/engine/installation/linux/ubuntu/" target="_blank" rel="noopener">Get Docker for Ubuntu - docs.docker.com</a></li>
<li><a href="https://github.com/docker/compose/releases" target="_blank" rel="noopener">Releases · docker/compose - github.com</a></li>
<li><a href="https://firefly-iii.github.io/using-docker.html" target="_blank" rel="noopener">Docker - Firefly III</a></li>
<li><a href="https://firefly-iii.github.io/using-installing.html" target="_blank" rel="noopener">Installation guide - Firefly III</a></li>
<li><a href="https://firefly-iii.github.io/using-upgrading.html" target="_blank" rel="noopener">Upgrade guide - Firefly III</a></li>
</ol>

      
    </div>

    

    
    
    

    

    
      
    
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>oing9179</li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    
    <a href="https://oing9179.github.io/blog/2017/201704-Setup-Firefly-the-Financial-Manager-using-Docker-Nginx/" title="用 Docker & Nginx 搭建自己的账本（Firefly）">https://oing9179.github.io/blog/2017/201704-Setup-Firefly-the-Financial-Manager-using-Docker-Nginx/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC</a> unless stating additionally.</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/blog/tags/Linux/" rel="tag"># Linux</a>
          
            <a href="/blog/tags/Nginx/" rel="tag"># Nginx</a>
          
            <a href="/blog/tags/Docker/" rel="tag"># Docker</a>
          
            <a href="/blog/tags/Firefly/" rel="tag"># Firefly</a>
          
            <a href="/blog/tags/Finical-Manager/" rel="tag"># Finical Manager</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2017/201704-Java-Concurrency-Multi-Threading-Introduction/" rel="next" title="Java 并发 & 多线程 - 基础知识">
                <i class="fa fa-chevron-left"></i> Java 并发 & 多线程 - 基础知识
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2017/201704-The-Magic-SysRq-Key/" rel="prev" title="SysRq 键 - Linux 系统崩掉前最后的救命稻草">
                SysRq 键 - Linux 系统崩掉前最后的救命稻草 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">oing9179</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/blog/archives/">
                
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/blog/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/blog/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">97</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/blog/rss2.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/oing9179" title="GitHub &rarr; https://github.com/oing9179" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://twitter.com/oing9179" title="Twitter &rarr; https://twitter.com/oing9179" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/blog/images/cc-by-nc.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Preface"><span class="nav-number">1.</span> <span class="nav-text">Preface</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装-amp-更新-Docker-docker-ce"><span class="nav-number">2.</span> <span class="nav-text">安装 &amp; 更新 Docker (docker-ce)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#构建和部署-Docker-Image"><span class="nav-number">3.</span> <span class="nav-text">构建和部署 Docker Image</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装-amp-配置-Nginx"><span class="nav-number">4.</span> <span class="nav-text">安装 &amp; 配置 Nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装-Nginx"><span class="nav-number">4.1.</span> <span class="nav-text">安装 Nginx</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成-Let’s-Encrypt-SSL-证书"><span class="nav-number">4.2.</span> <span class="nav-text">生成 Let’s Encrypt SSL 证书</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置-Nginx-使用-SSL"><span class="nav-number">4.3.</span> <span class="nav-text">配置 Nginx 使用 SSL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#初始化-Firefly"><span class="nav-number">5.</span> <span class="nav-text">初始化 Firefly</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#初始化数据库"><span class="nav-number">5.1.</span> <span class="nav-text">初始化数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注册并登录"><span class="nav-number">5.2.</span> <span class="nav-text">注册并登录</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#更新-Firefly"><span class="nav-number">6.</span> <span class="nav-text">更新 Firefly</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-备份数据库"><span class="nav-number">6.1.</span> <span class="nav-text">1. 备份数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-更新-docker-镜像"><span class="nav-number">6.2.</span> <span class="nav-text">2. 更新 docker 镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-收尾工作"><span class="nav-number">6.3.</span> <span class="nav-text">3. 收尾工作</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#总结"><span class="nav-number">7.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#更新历史"><span class="nav-number">8.</span> <span class="nav-text">更新历史</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">9.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">oing9179</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/blog/js/utils.js?v=7.1.2"></script>

  <script src="/blog/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/blog/js/schemes/muse.js?v=7.1.2"></script>




  
  <script src="/blog/js/scrollspy.js?v=7.1.2"></script>
<script src="/blog/js/post-details.js?v=7.1.2"></script>



  


  <script src="/blog/js/next-boot.js?v=7.1.2"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
